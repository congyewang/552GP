---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
neomod <- read.table("../neomod_isam12.dat", header = TRUE)

#plot(neomod)

summary(neomod)


# Attach to allow for better addressing
attach(neomod)

```


# Factorisation
Modify variables that are int or str to factor.
```{r}



neomod$cns    = factor(cns)
neomod$size   = factor(size)
neomod$gest   = factor(gest)
neomod$emp.f  = factor(emp.f)
neomod$emp.m  = factor(emp.m)
neomod$edu    = factor(edu)
neomod$re.ad  = factor(re.ad)
neomod$sex    = factor(sex)
neomod$accom  = factor(accom)


summary(neomod)

```
```{r}
head(neomod)
```
```{r}
# Representative Model
mod1 = glm(re.ad ~ bwt,
          data=neomod,
          family=binomial)



summary(mod1)
```


```{r}
# Representative plot
par(mfrow=c(1,1))
plot(neomod$bwt,
     neomod$re.ad,
     xlab="Baseline Count",
     ylab="Fortnightly Count")
abline(mod1, col=2)
```

```{r}
# Representative plot
plot(mod1)
```

```{r}
# Random model - probably wrong
mod2.re.ad = glm(re.ad ~ cns + size + gest + bwt + emp.f + emp.m + edu + sex + accom,
           data= neomod,
           family=binomial)

summary(mod2.re.ad)

plot(mod2.re.ad)
```
```{r}
# Random model - probably wrong
mod2.los = glm(los ~ cns + size + gest + bwt + emp.f + emp.m + edu + sex + accom,
           data= neomod,
           family=Gamma(link=inverse))

summary(mod2.los)

plot(mod2.los)
```
